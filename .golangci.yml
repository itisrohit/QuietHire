version: "2"

run:
  timeout: 5m
  tests: true
  modules-download-mode: readonly

linters:
  enable:
    # Default linters
    - errcheck      # Check for unchecked errors
    - govet         # Vet examines Go source code
    - ineffassign   # Detect ineffectual assignments
    - staticcheck   # Go static analysis (includes gosimple, stylecheck)
    - unused        # Check for unused code
    
    # Additional recommended linters
    - misspell      # Check spelling
    - revive        # Fast, configurable, extensible, flexible linter
    - gosec         # Security checker
    - goconst       # Find repeated strings that could be constants
    - gocyclo       # Computes cyclomatic complexity
    - dupl          # Code clone detection
    - unconvert     # Remove unnecessary type conversions
    - unparam       # Find unused function parameters
    - nakedret      # Find naked returns in functions
    - prealloc      # Find slice declarations that could be preallocated
    - nolintlint    # Ill-formed or insufficient nolint directives
    - gocritic      # Go source code linter

  settings:
    errcheck:
      check-type-assertions: true
      check-blank: false
      
    govet:
      enable:
        - shadow
      enable-all: true
      
    misspell:
      locale: US
      
    gocyclo:
      min-complexity: 15
      
    goconst:
      min-len: 3
      min-occurrences: 3
      
    dupl:
      threshold: 100
      
    nakedret:
      max-func-lines: 30
      
    prealloc:
      simple: true
      range-loops: true
      for-loops: false
      
    revive:
      rules:
        - name: blank-imports
        - name: context-as-argument
        - name: context-keys-type
        - name: dot-imports
        - name: error-return
        - name: error-strings
        - name: error-naming
        - name: exported
        - name: if-return
        - name: increment-decrement
        - name: var-naming
        - name: var-declaration
        - name: package-comments
        - name: range
        - name: receiver-naming
        - name: time-naming
        - name: unexported-return
        - name: indent-error-flow
        - name: errorf
        - name: empty-block
        - name: superfluous-else
        - name: unused-parameter
        - name: unreachable-code
        - name: redefines-builtin-id
        
    gosec:
      excludes:
        - G104  # Audit errors not checked (we use errcheck for this)
      config:
        G306: "0644"  # Acceptable file permissions
  
  exclusions:
    paths:
      - apps/crawler-go/parsers # Placeholder parsers - not yet implemented
    rules:
      # Exclude some linters from running on tests files
      - path: _test\.go
        linters:
          - gocyclo
          - errcheck
          - dupl
          - gosec
          - goconst
      
      # Exclude known issues in auto-generated files
      - path: \.pb\.go$
        linters:
          - all
          
      # Exclude some staticcheck messages
      - linters:
          - staticcheck
        text: "SA9003:"
        
      # Exclude lll issues for long lines with go:generate
      - linters:
          - lll
        source: "^//go:generate "

formatters:
  enable:
    - gofmt         # Check code formatting
    - goimports     # Check import ordering

  settings:
    gofmt:
      simplify: true
      
    goimports:
      local-prefixes: github.com/quiethire

issues:
  # Maximum issues count per one linter
  max-issues-per-linter: 50
  
  # Maximum count of issues with the same text
  max-same-issues: 3
  
  # Show only new issues
  new: false

output:
  formats:
    text:
      path: stdout
      colors: true
      print-issued-lines: true
      print-linter-name: true
  show-stats: true
